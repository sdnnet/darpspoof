\documentclass{article}

\usepackage[backend=biber]{biblatex}
\addbibresource{first.bib}
\usepackage[margin=2cm]{geometry}
\usepackage{titling}

\title{Algorithm For D-ARPSpoof}

\renewcommand{\maketitle}{

	\begin{center}
		{\huge\noindent\ignorespaces\textbf{\thetitle}\par}
	\end{center}
	\vspace{0.3in}
	
}
\begin{document}
\maketitle

\section{Data Structures Used}

\begin{enumerate}
	\item HashMap$<$OFPort,ArrayList$<$Vlan, IP, Mac$>$$>$ : ipPortMap
	\item HashMap$<$MacAddress,HashMap$<$Vlan,Switch-Port$>$$>$ : macPortMap
\end{enumerate}

\section{Algorithm}


\subsection{Handling Packet-IN DHCP Messages}


\subsubsection{Updating Data Structures} \label{dhcp-ds}


\begin{itemize}
	\item \textbf{DHCP REQUEST}

		\begin{enumerate}
			\item Delete the mapped mac address for inPort and incoming packet's MAC Address from macPortMap.
			\item If ipPortMap has entry for inPort and incomingPacket's vlan ID then delete that entry.
			\item If macPortMap does not have any entry for incoming packet's source MAC Address and vlan id, then add those entry in macPortMap.
		\end{enumerate}
	\item \textbf{DHCP ACKNOWLEDGEMENT} \label{dhcp-ack}
		\begin{enumerate}
			\item Get Switch-Port pair from macPortMap for destination mac address and vlan id and name that as pair.
			\item Add following entry in ipPortMap:

				\small{
					$<$\textit{pair.switch} ,  \textit{pair.port} , vid , dhcpPayload.yourIPAddress , destination-MAC$>$
				}
		\end{enumerate}

\end{itemize}


\subsubsection{Updating Flow Rules}

\begin{itemize}
	\item \textbf{DHCP REQUEST}

		\begin{enumerate}
			\item If ipPortMap has entry for received switch, input port and incomingPacket's vlan id then remove flow entry from current switch with :

				\begin{itemize}
					\item inPort : incomingPacket's input port.
					\item vlan-vid : incomingPacket's vlan id
				\end{itemize}
				
		\end{enumerate}
	\item \textbf{DHCP ACKNOWLEDGEMENT}

		\begin{enumerate}
			\item Get Switch-Port pair from macPortMap for destination mac address and vlan id and name that as pair.
			\item Then add a flow rule to block all ARP packet from the  current input port. Write this flow with priority 10.
			\item Add flow in \textit{pair.switch} to direct the packet with 

				\begin{itemize}

					\item IP address : dhcp-payload's yourIPAddress
					\item vlan-vid : incomingPacket's vlan id 
					\item inPort : \textit{pair.port}
				\end{itemize}

				to goto flow table 1 of \textit{pair.switch} . Write this flow with priority 20.
		\end{enumerate}
		
\end{itemize}




\subsection{Handling DHCP-ACK PacketOut Messages}

Same as section \ref{dhcp-ds} DHCP ACKNOWLEDGEMENT handling.

\subsection{Handling Switch Added event}

\begin{enumerate}
	\item Write flow rule to forward all ARP packets to controller in flow table 1 of added switch with priority 0. (Default flow for table 1) 
\end{enumerate}

\subsection{Handling Switch Removed event}

\begin{enumerate}
	\item Remove all entry of removed swith from ipPortMap
	\item Also, Remove all entry of removed switch from macPortMap.
\end{enumerate}

\printbibliography
\end{document}
